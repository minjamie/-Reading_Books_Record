# 05 클로저

클로저는 여러 함수형 프로그래밍 언어에서 등장하는 보편적인 특정이다.

### 01. 클로저의 정의 및 원리 이해

    - 함수와 렉시컬 환경의 조합으로 함수가 생성될 당시의 외부 변수를 기억하여 생성 이후에도 계속 접근이 가능한 현상

    1. 클로저

    "클로저는 함수와 그 함수가 선언될 당시 lexical environment의 상호관계 따른 현상" 정도가 된다.
    **정리하면 어떤 함수에서 선언한 변수를 참조하는 내부함수에서만 발생하는 현상**

    선언될 당시 lexical environment는 실행 컨텍스트 구성 요소 중 outerEnvironmnetReference에 해당한다.

    내부함수에서 외부 변수를 참조하는 경우에 한해서만 combination, 즉 ‘선언될 당시 lexical environment의 상호관계’가 의미가 있다.

    2. 외부 함수의 변수를 참조하는 내부 함수
     외부 함수의 lexical environment가 가비지 컬렉팅되지 되지 않는 현상을 의미
    3. return 없이도 클로저가 발생하는 경우

---

### 02. 클로저와 메모리 관리

    4. 클로저 메모
      **클로저는 어떤 필요에 의해 의도적으로 함의 지역변수를 메모리를 소모하도록 함으로서 발생하므로
      그 필요성이 사라진 시점에서 더는 메모리를 소모하지 않게 해주면 된다.**

    클로저는 객체지향과 함수형 모두를 아우르는 중요한 개념
    메모리 소모는 클로저의 본질적인 특성으로 이러한 특성을 정확히 이해하고 잘 활용하도록 노력해야한다.

    메모리 누수라는 표현은 개발자의 의도와 달리 어떤 값의 참조 카운트가 0이되지 않아 CG의 수거 대상이 되지않는 경우에는 맞는 표현이다.

    방법? - 참조 카운트 0으로 하기 위해 식별자에 참조형이 아니 기본형 데이터를 (보통 null, undefined 등) 할당하면 된다.

---

### 03. 클로저 활용 사례

    클로저는 다양한 곳에서 광범위하게 활용된다

    5. 콜백 함수 내부에서 외부 데이터를 사용하고자 할때
      콜백 함수 내부에서 외부변수를 참조하기 위해선 3가지 방식이 있다

    5_1. 콜백 함수를 내부함수로 선언해서 외부변수를 직접 참조하는 방법

    5_2. bind를 활용하면 메서드로 값을 직접 넘기는 방식
    클로저는 발생하지 않게된 반면 여러가지 제약사항 발생 - 이벤트 객체가 인자로 넘어오는 순서가 바뀌거나 함수 내부에서의 this가 원래의 그것과 달라지는 점

    5_3.콜백 함수를 고차함수로 바꿔 클로저를 적극적으로 활용
    함수형 프로그래밍에서 자주쓰이는 방식

    ---

    ### 04. 접근 권한 제어(정보 은닉)저

    6. 정보 은닉
      \*\*정보 은닉은 어떤 모듈의 내부 로직에 의해 외부로의 노출을 최소화해서 모듈간의 결합도를 낮추고 유연성을 높이고자하는 중요한 개념 중 하나이다.

    흔히 접근 권한엔 public, private, protected 세가지 종류가 있다.

        pulic - 외부에서 접근 가능
        private - 내부에서만 사용하며 외부에 노출되지 않는 것 의미

    클로저를 이용하면 함수 차원에서 pulic한 값, private한 값 구분하는 것 가능하다.\*\*

    클로저를 활용하면 외부 스코프에서 함수 내부의 변수들 중 선택적으로 일부의 변수에 대한 접근 권한을 부여할 수있는데  return을 활용해서 가능하다

    이유 -return 값이 외부에 정보를 제공하는 유일한 수단이기에
    방법 - 외부에 제공하자고자 하는 정보들 모아서 return 하고 내부에서만 사용할 정보들은 return 하지 않는 것으로 접근 권한 제어가 가능해 return 한 변수들은 공개멤버, 그렇지 않은 변수들은 비공개 멤버가 된다.
    1> 함수에서 지역변수 및 내부 함수등을 선언한다
    2> 외부에 접근권한을 주고자  하는 대상들로 구성된 참조형 데이터(대상이 여럿일 땐 객체 또는 배열 하나일 땐 함수)를 리턴한다
    → 리턴한 변수들은 공개멤버, 그렇지 않은 변수들은 비공개 멤버

    즉 객체 대신 함수를 만들어 외부에 제공할 정보만 return 하도록

7. 어뷰징까지 막기 위한 방식
   객체를 return 하기 전 미리 변경할 수 없게 끔
   **Object.freeze(publicMembers)**

8. 부분 적용 함수
   부분 적용 함수 \*\*n개의 인자를 받는 함수에 미리 m개의 인자만 넘겨 기억시켰다가 나중에 (n-m)개의 인자를 넘기면 비로소 원래 함수의 실행 결과를 얻을 수 있게끔 하는 함수

   미리 일부 인자를 넘겨두어 기억하게 끔 하고 추후 필요한 시점에 기억했던 인자들까지 함께 실행하게 한다는 개념 자체가 클로저에 정의에 부함

9. 디바운스 ?

   - 짧은 시간 동안 동일한 이벤트가 많이 발생할 경우 이를 전부 처리하지 않고 처음 또는 마지막에 발생한 이벤트에 대해 한 번만 처리하는 것으로 프론트엔드 성능 최적화에 도움을 주는 기능

   - `_`비어놓음 사용위 해 전역공간 침범하는 대신 Symbol.for 메서드를 사용하면 전역 심볼 공간에 인자로 넘어온 문자열이 이미 있으면 해당 값 참조, 선언안돼있으면 새로 만드는 방식으로 어디서든 접근 가능한 유일무일 한 상수 생성시 적합\*\*

10. 커링 함수
    여러개의 인자를 받는 함수를 하나의 인자만 받는 함수로 나눠서 순차적으로 호출할 수 있게 체인 형태로 구성된 것

    화살표 함수를 사용하면 한줄로 표현해 이해하기 수월

    언제? 당장 필요한 정보만 받아서 전달하고 또 필요한 정보가 들어오면 전달하는 식으로 하여 결국 마지막 인자가 넘어갈 때까지 함수실행을 미루는데 , 함수 프로그래밍에선 **지연실행이라** 칭함

    예 - 플럭스 아키텍처의 구현체 리덕스의 미들웨어
